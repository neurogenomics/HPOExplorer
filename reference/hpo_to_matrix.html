<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>HPO to matrix — hpo_to_matrix • HPOExplorer</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="HPO to matrix — hpo_to_matrix"><meta property="og:description" content='Convert gene-phenotype associations from the Human Phenotype Ontology (HPO)
into a gene x phenotype matrix. The returned matrix is sparse and binary,
such that 1 indicates a the gene is associated with a given phenotype
according to the HPO annotation, and 0 indicates it is not.
By default, full phenotype names are used as the column names
(e.g. "Abnormality of body height"),
however you can instead set them to the HPO IDs
by changing the formula argument to:
formula = "gene_symbol ~ hpo_id".
Phenotypes that are not present in the phenotype_to_genes annotations
are omitted from the final matrix.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HPOExplorer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/HPOExplorer.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/docker.html">Docker</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/neurogenomics/HPOExplorer/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>HPO to matrix</h1>
    <small class="dont-index">Source: <a href="https://github.com/neurogenomics/HPOExplorer/blob/HEAD/R/hpo_to_matrix.R" class="external-link"><code>R/hpo_to_matrix.R</code></a></small>
    <div class="hidden name"><code>hpo_to_matrix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Convert gene-phenotype associations from the Human Phenotype Ontology (HPO)
into a gene x phenotype matrix. The returned matrix is sparse and binary,
such that 1 indicates a the gene is associated with a given phenotype
according to the HPO annotation, and 0 indicates it is not.
By default, full phenotype names are used as the column names
(e.g. "Abnormality of body height"),
however you can instead set them to the HPO IDs
by changing the <code>formula</code> argument to:
<code>formula = "gene_symbol ~ hpo_id"</code>.
Phenotypes that are not present in the <code>phenotype_to_genes</code> annotations
are omitted from the final matrix.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hpo_to_matrix</span><span class="op">(</span></span>
<span>  terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  phenotype_to_genes <span class="op">=</span> <span class="fu"><a href="load_phenotype_to_genes.html">load_phenotype_to_genes</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  formula <span class="op">=</span> <span class="st">"gene_symbol ~ hpo_name"</span>,</span>
<span>  fun.aggregate <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  value.var <span class="op">=</span> <span class="st">"evidence_score_mean"</span>,</span>
<span>  fill <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  run_cor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  as_matrix <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  as_sparse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>terms</dt>
<dd><p>A subset of HPO IDs to include.
Set to <code>NULL</code> (default) to include all terms.</p></dd>


<dt>phenotype_to_genes</dt>
<dd><p>Output of
<a href="load_phenotype_to_genes.html">load_phenotype_to_genes</a> mapping phenotypes
to gene annotations.</p></dd>


<dt>formula</dt>
<dd><p>A formula of the form LHS ~ RHS to cast, see Details.</p></dd>


<dt>fun.aggregate</dt>
<dd><p>Should the data be aggregated before casting? If the formula doesn't identify a single observation for each cell, then aggregation defaults to <code>length</code> with a message.</p>
<p>To use multiple aggregation functions, pass a <code>list</code>; see Examples.</p></dd>


<dt>value.var</dt>
<dd><p>Name of the column whose values will be filled to cast. Function <code>guess()</code> tries to, well, guess this column automatically, if none is provided.</p>
<p>Cast multiple <code>value.var</code> columns simultaneously by passing their names as a <code>character</code> vector. See Examples.</p></dd>


<dt>fill</dt>
<dd><p>Value with which to fill missing cells. If <code>fun.aggregate</code> is present, takes the value by applying the function on a 0-length vector.</p></dd>


<dt>run_cor</dt>
<dd><p>Return a matrix of pairwise correlations.</p></dd>


<dt>as_matrix</dt>
<dd><p>Return the results as a matrix (<code>TRUE</code>).
Otherwise, will return the results as a <a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a>
with an extra column "gene_symbol".</p></dd>


<dt>as_sparse</dt>
<dd><p>Convert the data to a sparse matrix.
Only used when <code>as_matrix=TRUE</code>.</p></dd>


<dt>method</dt>
<dd><p>a character string indicating which correlation
    coefficient (or covariance) is to be computed.  One of
    <code>"pearson"</code> (default), <code>"kendall"</code>, or <code>"spearman"</code>:
    can be abbreviated.</p></dd>


<dt>verbose</dt>
<dd><p>Print messages.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A gene x phenotype matrix,
or a phenotype x phenotype matrix if <code>run_cor=TRUE</code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="example_phenos.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> All local files already up-to-date!</span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">hpo_to_matrix</span><span class="op">(</span>terms <span class="op">=</span> <span class="va">phenos</span><span class="op">$</span><span class="va">hpo_id</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: Matrix</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Constructing HPO gene x phenotype matrix.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Annotating gene-disease associations with Evidence score</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Annotating phenos with Disease</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Gathering data from GenCC.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Importing cached file.</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Brian Schilder, Robert Gordon-Smith, Nathan Skene.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

