<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add functions — add_ • HPOExplorer</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add functions — add_"><meta property="og:description" content="Functions to add metadata to data.table objects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HPOExplorer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/HPOExplorer.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/docker.html">Docker/Singularity Containers</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/neurogenomics/HPOExplorer/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add functions</h1>
    <small class="dont-index">Source: <a href="https://github.com/neurogenomics/HPOExplorer/blob/master/R/0docs.R" class="external-link"><code>R/0docs.R</code></a>, <a href="https://github.com/neurogenomics/HPOExplorer/blob/master/R/add_ancestor.R" class="external-link"><code>R/add_ancestor.R</code></a>, <a href="https://github.com/neurogenomics/HPOExplorer/blob/master/R/add_death.R" class="external-link"><code>R/add_death.R</code></a>, and 18 more</small>
    <div class="hidden name"><code>add_.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions to add metadata to data.table objects.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_ancestor</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  lvl <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  hpo <span class="op">=</span> <span class="fu"><a href="get_.html">get_hpo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  keep_descendants <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  remove_descendants <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  force_new <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_death</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  keep_deaths <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allow.cartesian <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  agg_by <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_disease_genes</span><span class="op">(</span><span class="va">phenos</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_evidence</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  evidence_score_threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  evidence_score_threshold_metric <span class="op">=</span> <span class="st">"evidence_score_sum"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allow.cartesian <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  agg_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"disease_id"</span>, <span class="st">"gene_symbol"</span><span class="op">)</span>,</span>
<span>  default_score <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_gene_frequency</span><span class="op">(</span></span>
<span>  phenotype_to_genes <span class="op">=</span> <span class="fu"><a href="load_phenotype_to_genes.html">load_phenotype_to_genes</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  gene_frequency_threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allow.cartesian <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_genes</span><span class="op">(</span></span>
<span>  phenos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  phenotype_to_genes <span class="op">=</span> <span class="fu"><a href="load_phenotype_to_genes.html">load_phenotype_to_genes</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  hpo <span class="op">=</span> <span class="fu"><a href="get_.html">get_hpo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hpo_id"</span>, <span class="st">"hpo_name"</span>, <span class="st">"disease_id"</span>, <span class="st">"disease_name"</span>, <span class="st">"disease_description"</span><span class="op">)</span>,</span>
<span>  gene_col <span class="op">=</span> <span class="st">"gene_symbol"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  allow.cartesian <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_gpt_annotations</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  annot <span class="op">=</span> <span class="fu"><a href="gpt_annot_codify.html">gpt_annot_codify</a></span><span class="op">(</span>reset_weights_dict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">annot_weighted</span>,</span>
<span>  annot_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">annot</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">annot</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hpo_id"</span>, <span class="st">"hpo_name"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  gpt_filters <span class="op">=</span> <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">annot_cols</span><span class="op">)</span><span class="op">)</span>, <span class="va">annot_cols</span><span class="op">)</span>,</span>
<span>  force_new <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_hpo_definition</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  hpo <span class="op">=</span> <span class="fu"><a href="get_.html">get_hpo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  line_length <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_api <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_hpo_id</span><span class="op">(</span><span class="va">phenos</span>, hpo <span class="op">=</span> <span class="fu"><a href="get_.html">get_hpo</a></span><span class="op">(</span><span class="op">)</span>, ignore_case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_hpo_name</span><span class="op">(</span><span class="va">phenos</span>, hpo <span class="op">=</span> <span class="fu"><a href="get_.html">get_hpo</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_info_content</span><span class="op">(</span><span class="va">phenos</span>, hpo <span class="op">=</span> <span class="fu"><a href="get_.html">get_hpo</a></span><span class="op">(</span><span class="op">)</span>, force_new <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_mondo</span><span class="op">(</span><span class="va">phenos</span>, input_col <span class="op">=</span> <span class="st">"disease_id"</span>, map_to <span class="op">=</span> <span class="st">"hpo"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_ndisease</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  pheno_ndiseases_threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allow.cartesian <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_omop</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  input_col <span class="op">=</span> <span class="st">"hpo_id"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allow.cartesian <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  force_new <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_onset</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  keep_onsets <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  agg_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allow.cartesian <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_ont_lvl</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  hpo <span class="op">=</span> <span class="fu"><a href="get_.html">get_hpo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  absolute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  keep_ont_levels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_pheno_frequency</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  pheno_frequency_threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allow.cartesian <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_prevalence</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  input_col <span class="op">=</span> <span class="st">"disease_id"</span>,</span>
<span>  drop_na <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"orphanet"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_severity</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  hpo <span class="op">=</span> <span class="fu"><a href="get_.html">get_hpo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allow.cartesian <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  severity_threshold <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_tier</span><span class="op">(</span></span>
<span>  <span class="va">phenos</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_disease_characteristics <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  auto_assign <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hpo <span class="op">=</span> <span class="fu"><a href="get_.html">get_hpo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  keep_tiers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-phenos">phenos<a class="anchor" aria-label="anchor" href="#arg-phenos"></a></dt>
<dd><p>A data.table containing HPO IDs and other metadata.</p></dd>


<dt id="arg-lvl">lvl<a class="anchor" aria-label="anchor" href="#arg-lvl"></a></dt>
<dd><p>How many levels deep into the ontology to get ancestors from.
For example:</p><dl><dt>1</dt>
<dd><p>"All"</p></dd>

<dt>2</dt>
<dd><p>"Phenotypic abnormality"</p></dd>

<dt>3</dt>
<dd><p>"Abnormality of the nervous system"</p></dd>

<dt>4</dt>
<dd><p>"Abnormality of nervous system physiology"</p></dd>

<dt>5</dt>
<dd><p>"Neurodevelopmental abnormality" or "Behavioral abnormality"</p></dd>


</dl></dd>


<dt id="arg-hpo">hpo<a class="anchor" aria-label="anchor" href="#arg-hpo"></a></dt>
<dd><p>Human Phenotype Ontology object,
loaded from <a href="https://rdrr.io/pkg/KGExplorer/man/get_.html" class="external-link">get_ontology</a>.</p></dd>


<dt id="arg-keep-descendants">keep_descendants<a class="anchor" aria-label="anchor" href="#arg-keep-descendants"></a></dt>
<dd><p>Terms whose descendants should be kept
(including themselves).
 Set to <code>NULL</code> (default) to skip this filtering step.</p></dd>


<dt id="arg-remove-descendants">remove_descendants<a class="anchor" aria-label="anchor" href="#arg-remove-descendants"></a></dt>
<dd><p>Terms whose descendants should be removed
(including themselves).
 Set to <code>NULL</code> (default) to skip this filtering step.</p></dd>


<dt id="arg-force-new">force_new<a class="anchor" aria-label="anchor" href="#arg-force-new"></a></dt>
<dd><p>Force a new query to the OARD API instead of
using pre-downloaded data.</p></dd>


<dt id="arg-keep-deaths">keep_deaths<a class="anchor" aria-label="anchor" href="#arg-keep-deaths"></a></dt>
<dd><p>The age of death associated with each HPO ID to keep.
If &gt;1 age of death is associated with the term,
only the earliest age is considered.
See add_death for details.</p></dd>


<dt id="arg-all-x">all.x<a class="anchor" aria-label="anchor" href="#arg-all-x"></a></dt>
<dd><p>logical; if <code>TRUE</code>, rows from <code>x</code> which have no matching row
in <code>y</code> are included. These rows will have 'NA's in the columns that are usually
filled with values from <code>y</code>. The default is <code>FALSE</code> so that only rows with
data from both <code>x</code> and <code>y</code> are included in the output.</p></dd>


<dt id="arg-allow-cartesian">allow.cartesian<a class="anchor" aria-label="anchor" href="#arg-allow-cartesian"></a></dt>
<dd><p>See <code>allow.cartesian</code> in <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">[.data.table</a></code>.</p></dd>


<dt id="arg-agg-by">agg_by<a class="anchor" aria-label="anchor" href="#arg-agg-by"></a></dt>
<dd><p>Column to aggregate age of onset metadata by.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Print messages.</p></dd>


<dt id="arg-evidence-score-threshold">evidence_score_threshold<a class="anchor" aria-label="anchor" href="#arg-evidence-score-threshold"></a></dt>
<dd><p>The minimum threshold of mean
evidence scores of each gene-phenotype association to keep.</p></dd>


<dt id="arg-evidence-score-threshold-metric">evidence_score_threshold_metric<a class="anchor" aria-label="anchor" href="#arg-evidence-score-threshold-metric"></a></dt>
<dd><p>The metric to use for filtering with
<code>evidence_score_threshold</code>.</p></dd>


<dt id="arg-default-score">default_score<a class="anchor" aria-label="anchor" href="#arg-default-score"></a></dt>
<dd><p>Default evidence score to
apply to gene-disease associations that are present in the HPO annotations
but don't have evidence scores in the GenCC annotations.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="https://rdrr.io/pkg/KGExplorer/man/get_.html" class="external-link">KGExplorer::get_gencc</a></code>, <code><a href="https://rdrr.io/pkg/KGExplorer/man/map_.html" class="external-link">KGExplorer::map_mondo</a></code>, <code><a href="https://rdrr.io/pkg/KGExplorer/man/get_.html" class="external-link">KGExplorer::get_ontology_levels</a></code></p><dl><dt><code>save_dir</code></dt>
<dd><p>Directory to save a file to.</p></dd>

    <dt><code>dict</code></dt>
<dd><p>A named vector of evidence score mappings.
See <a href="https://thegencc.org/faq.html#validity-termsdelphi-survey" class="external-link">here</a>
for more information.</p></dd>

    <dt><code>dat</code></dt>
<dd><p><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a> with genes.</p></dd>

    <dt><code>output_col</code></dt>
<dd><p>Column name of output IDs.</p></dd>

    <dt><code>to</code></dt>
<dd><p>Character vector of database(s) to map IDs to.
When not <code>"mondo"</code>, can supply multiple alternative databases to map to
 (e.g. <code>c("OMIM","Orphanet","DECIPHER")</code>).</p></dd>

    <dt><code>map_types</code></dt>
<dd><p>Mapping types to include.</p></dd>

    <dt><code>top_n</code></dt>
<dd><p>Top number of mappings to return per <code>top_by</code> grouping.
Set to <code>NULL</code> to skip this step.</p></dd>

    <dt><code>add_name</code></dt>
<dd><p>Logical, if TRUE, add mondo name column.</p></dd>

    <dt><code>add_definitions</code></dt>
<dd><p>logical, if TRUE, add mondo definition column.</p></dd>

    <dt><code>ont</code></dt>
<dd><p>An ontology of class <a href="https://rdrr.io/pkg/simona/man/ontology_DAG-class.html" class="external-link">ontology_DAG</a>.</p></dd>

    <dt><code>terms</code></dt>
<dd><p>A vector of ontology term IDs.</p></dd>

    <dt><code>remove_terms</code></dt>
<dd><p>Character vector of term IDs to exclude.</p></dd>

    <dt><code>reverse</code></dt>
<dd><p>If <code>TRUE</code>, ontology
level numbers with be revered such that the level of the parent terms
are larger than the child terms.</p></dd>


</dl></dd>


<dt id="arg-phenotype-to-genes">phenotype_to_genes<a class="anchor" aria-label="anchor" href="#arg-phenotype-to-genes"></a></dt>
<dd><p>Output of
<a href="load_phenotype_to_genes.html">load_phenotype_to_genes</a> mapping phenotypes
to gene annotations.</p></dd>


<dt id="arg-gene-frequency-threshold">gene_frequency_threshold<a class="anchor" aria-label="anchor" href="#arg-gene-frequency-threshold"></a></dt>
<dd><p>Only keep genes with frequency
above the set threshold. Frequency ranges from 0-100 where 100 is
a gene that occurs 100% of the time in a given phenotype.
Include <code>NA</code> if you wish to retain genes that
do not have any frequency data.
See add_gene_frequency for details.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>A vector of shared column names in <code>x</code> and <code>y</code> to merge on.
This defaults to the shared key columns between the two tables.
If <code>y</code> has no key columns, this defaults to the key of <code>x</code>.</p></dd>


<dt id="arg-gene-col">gene_col<a class="anchor" aria-label="anchor" href="#arg-gene-col"></a></dt>
<dd><p>Name of the gene column.</p></dd>


<dt id="arg-annot">annot<a class="anchor" aria-label="anchor" href="#arg-annot"></a></dt>
<dd><p>GPT annotation data.</p></dd>


<dt id="arg-annot-cols">annot_cols<a class="anchor" aria-label="anchor" href="#arg-annot-cols"></a></dt>
<dd><p>Columns to add.</p></dd>


<dt id="arg-gpt-filters">gpt_filters<a class="anchor" aria-label="anchor" href="#arg-gpt-filters"></a></dt>
<dd><p>A named list of filters to apply to the GPT annotations.</p></dd>


<dt id="arg-line-length">line_length<a class="anchor" aria-label="anchor" href="#arg-line-length"></a></dt>
<dd><p>The number of desired words per line \&lt;int\&gt;</p></dd>


<dt id="arg-use-api">use_api<a class="anchor" aria-label="anchor" href="#arg-use-api"></a></dt>
<dd><p>Get definitions from the HPO API,
as opposed to a static local dataset.</p></dd>


<dt id="arg-ignore-case">ignore_case<a class="anchor" aria-label="anchor" href="#arg-ignore-case"></a></dt>
<dd><p>Ignore case when mapping terms.</p></dd>


<dt id="arg-input-col">input_col<a class="anchor" aria-label="anchor" href="#arg-input-col"></a></dt>
<dd><p>Name of the column containing the disease or phenotype IDs.</p></dd>


<dt id="arg-map-to">map_to<a class="anchor" aria-label="anchor" href="#arg-map-to"></a></dt>
<dd><p>Mapping outputs to include
(from Mondo IDs to another database's IDs).</p></dd>


<dt id="arg-pheno-ndiseases-threshold">pheno_ndiseases_threshold<a class="anchor" aria-label="anchor" href="#arg-pheno-ndiseases-threshold"></a></dt>
<dd><p>Filter phenotypes by the
maximum number of diseases they are associated with.</p></dd>


<dt id="arg-keep-onsets">keep_onsets<a class="anchor" aria-label="anchor" href="#arg-keep-onsets"></a></dt>
<dd><p>The age of onset associated with each HPO ID to keep.
If &gt;1 age of onset is associated with the term,
only the earliest age is considered.
See add_onset for details.</p></dd>


<dt id="arg-absolute">absolute<a class="anchor" aria-label="anchor" href="#arg-absolute"></a></dt>
<dd><p>Make the levels absolute in the sense that they consider
the entire ontology (<code>TRUE</code>).
Otherwise, levels will be relative to only the terms that are in
 the provided subset of <code>terms</code> AND are directly adjacent (connected)
 to a given cluster of terms (<code>FALSE</code>).</p></dd>


<dt id="arg-keep-ont-levels">keep_ont_levels<a class="anchor" aria-label="anchor" href="#arg-keep-ont-levels"></a></dt>
<dd><p>Only keep phenotypes at certain <em>absolute</em>
ontology levels to keep.
See add_ont_lvl for details.</p></dd>


<dt id="arg-pheno-frequency-threshold">pheno_frequency_threshold<a class="anchor" aria-label="anchor" href="#arg-pheno-frequency-threshold"></a></dt>
<dd><p>Only keep phenotypes with frequency
above the set threshold. Frequency ranges from 0-100 where 100 is
a phenotype that occurs 100% of the time in all associated diseases.
Include <code>NA</code> if you wish to retain phenotypes that
do not have any frequency data.
See add_pheno_frequency for details.</p></dd>


<dt id="arg-drop-na">drop_na<a class="anchor" aria-label="anchor" href="#arg-drop-na"></a></dt>
<dd><p>Whether to drop rows with missing prevalence data.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>One of "orphanet" or "oard".</p></dd>


<dt id="arg-severity-threshold">severity_threshold<a class="anchor" aria-label="anchor" href="#arg-severity-threshold"></a></dt>
<dd><p>Only keep phenotypes with a mean
severity score (averaged across multiple associated diseases) below the
set threshold. The severity score ranges from 1-4 where 1 is the MOST severe.
Include <code>NA</code> if you wish to retain phenotypes that
do not have any severity score.</p></dd>


<dt id="arg-include-disease-characteristics">include_disease_characteristics<a class="anchor" aria-label="anchor" href="#arg-include-disease-characteristics"></a></dt>
<dd><p>Include <code>phenotypes</code> that
are also high-level <code>include_disease_characteristics</code>.</p></dd>


<dt id="arg-auto-assign">auto_assign<a class="anchor" aria-label="anchor" href="#arg-auto-assign"></a></dt>
<dd><p>Automatically assing HPO IDs to Tiers by conducting
regex searches for keywords that appear in the term name,
or the names of its descendants or ancestors.</p></dd>


<dt id="arg-keep-tiers">keep_tiers<a class="anchor" aria-label="anchor" href="#arg-keep-tiers"></a></dt>
<dd><p>Tiers from <a href="hpo_tiers.html">hpo_tiers</a> to keep.
Include <code>NA</code> if you wish to retain phenotypes that
do not have any Tier assignment.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Annotated data.</p>
<p>phenos data.table with extra columns:</p><dl><dt>"AgeOfDeath"</dt>
<dd><p>AgeOfDeath HPO IDs of disease phenotypes associated
with the target hpo_id phenotype.</p></dd>

<dt>"AgeOfDeath_names"</dt>
<dd><p>AgeOfDeath HPO names of disease phenotypes
associated with the target hpo_id phenotype.</p></dd>

<dt>"AgeOfDeath_counts"</dt>
<dd><p>The number of times each term in
"AgeOfDeath_names" appears across associated disease phenotypes.</p></dd>

<dt>"AgeOfDeath_score_mean"</dt>
<dd><p>Mean age of death score.</p></dd>

<dt>"AgeOfDeath_score_min"</dt>
<dd><p>Minimum age of death score.</p></dd>

<dt>"AgeOfDeath_top"</dt>
<dd><p>The most common age of death term.</p></dd>

<dt>"AgeOfDeath_earliest"</dt>
<dd><p>The earliest age of death.</p></dd>

<dt>"AgeOfDeath_latest"</dt>
<dd><p>The latest age of death.</p></dd>


</dl><p>phenos data.table with extra columns:</p><dl><dt>"evidence_score_min"</dt>
<dd><p>Minimum evidence score.</p></dd>

<dt>"evidence_score_max"</dt>
<dd><p>Maximum evidence score.</p></dd>

<dt>"evidence_score_mean"</dt>
<dd><p>Mean evidence score.</p></dd>


</dl><p>phenos data.table with extra column</p>
<p>A named vector of HPO term descriptions.</p>
<p>phenos data.table with extra column</p>
<p>phenos data.table with extra columns.</p>
<p>phenos data.table with extra columns</p>
<p>phenos data.table with extra columns:</p><dl><dt>"onset"</dt>
<dd><p>onset HPO IDs of disease phenotypes associated
with the target hpo_id phenotype.</p></dd>

<dt>"onset_names"</dt>
<dd><p>onset HPO names of disease phenotypes associated
with the target hpo_id phenotype.</p></dd>

<dt>"onset_counts"</dt>
<dd><p>The number of times each term in
"onset_names" appears across associated disease phenotypes.</p></dd>

<dt>"onset_score_mean"</dt>
<dd><p>Mean onset score.</p></dd>

<dt>"onset_score_min"</dt>
<dd><p>Minimum onset score.</p></dd>

<dt>"onset_top"</dt>
<dd><p>The most common onset term.</p></dd>

<dt>"onset_earliest"</dt>
<dd><p>The earliest age of onset.</p></dd>

<dt>"onset_latest"</dt>
<dd><p>The latest age of onset.</p></dd>


</dl><p>phenos data.table with extra column</p>
<p>phenos data.table with extra column</p>
<p>phenos data.table with extra columns</p>
<p>phenos data.table with extra column</p>
    </div>
    <div id="functions">
    <h2>Functions</h2>

<ul><li><p><code>add_ancestor()</code>: add_
Add ancestor</p>
<p>Assign each HPO ID to the higher-order ancestral term that it is part of.</p></li>
<li><p><code>add_death()</code>: add_
Add age of death</p>
<p>Add age of death for each HPO ID.
AgeOfDeath IDs and assigned "AgeOfDeath_score" values:</p><dl><dt>HP:0005268 </dt>
<dd><p>"Miscarriage" (AgeOfDeath_score=1)</p></dd>

<dt>HP:0003826 </dt>
<dd><p>"Stillbirth" (AgeOfDeath_score=1)</p></dd>

<dt>HP:0034241 </dt>
<dd><p>"Prenatal death" (AgeOfDeath_score=1)</p></dd>

<dt>HP:0003811 </dt>
<dd><p>"Neonatal death" (AgeOfDeath_score=2)</p></dd>

<dt>HP:0001522 </dt>
<dd><p>"Death in infancy" (AgeOfDeath_score=3)</p></dd>

<dt>HP:0003819 </dt>
<dd><p>"Death in childhood" (AgeOfDeath_score=4)</p></dd>

<dt>HP:0011421 </dt>
<dd><p>"Death in adolescence" (AgeOfDeath_score=5)</p></dd>

<dt>HP:0100613 </dt>
<dd><p>"Death in early adulthood" (AgeOfDeath_score=6)</p></dd>

<dt>HP:0033764 </dt>
<dd><p>"Death in middle age" (AgeOfDeath_score=7)</p></dd>

<dt>HP:0033763 </dt>
<dd><p>"Death in adulthood" (AgeOfDeath_score=7)</p></dd>

<dt>HP:0033765 </dt>
<dd><p>"Death in late adulthood" (AgeOfDeath_score=8)</p></dd>


</dl></li>
<li><p><code>add_disease_genes()</code>: add_
Add disease genes</p>
<p>Add genes that overlap between an HPO ID and an associated phenotype.</p></li>
<li><p><code>add_evidence()</code>: add_
Add evidence</p>
<p>Add the strength of evidence supporting each gene-disease association.
<a href="https://thegencc.org/faq.html#validity-termsdelphi-survey" class="external-link">
Delphi survey</a> evidence classification IDs and
assigned "evidence_score" values:</p><dl><dt>GENCC:100001 </dt>
<dd><p>"Definitive" (evidence_score=6)</p></dd>

<dt>GENCC:100002 </dt>
<dd><p>"Strong" (evidence_score=5)</p></dd>

<dt>GENCC:100003 </dt>
<dd><p>"Moderate" (evidence_score=4)</p></dd>

<dt>GENCC:100009 </dt>
<dd><p>"Supportive" (evidence_score=3)</p></dd>

<dt>GENCC:100004 </dt>
<dd><p>"Limited" (evidence_score=2)</p></dd>

<dt>GENCC:100005 </dt>
<dd><p>"Disputed Evidence" (evidence_score=1)</p></dd>

<dt>GENCC:100006 </dt>
<dd><p>"Refuted Evidence" (evidence_score=0)</p></dd>

<dt>GENCC:100008 </dt>
<dd><p>"No Known Disease Relationship" (evidence_score=0)</p></dd>


</dl></li>
<li><p><code>add_gene_frequency()</code>: add_
Add gene frequency</p>
<p>Add gene-level frequency, i.e. how often mutations in a given gene
are associated with a given phenotype.
Numeric frequency columns are on a 0-100% scale.</p></li>
<li><p><code>add_genes()</code>: add_
Add genes</p>
<p>Add genes associated with each phenotype
(in the context of a particular disease).</p></li>
<li><p><code>add_gpt_annotations()</code>: add_
Add ancestor</p>
<p>Add annotations generated with a Large Language Model.</p></li>
<li><p><code>add_hpo_definition()</code>: add_
Get term definition</p>
<p>This function accesses the HPO API to get a description/definition of an
HPO term. If a <code>line_length</code> \&gt; 0 is passed to the function, it will add
newlines every nth word. This can be useful when displaying the description
in plots with limited space.</p></li>
<li><p><code>add_hpo_id()</code>: add_
Add HPO ID column to dataframe</p>
<p>Adds the HPO term ID column "hpo_id".</p></li>
<li><p><code>add_hpo_name()</code>: add_
Add HPO name column to dataframe</p>
<p>Adds the HPO term name column "hpo_name".</p></li>
<li><p><code>add_info_content()</code>: add_
Add information content</p>
<p>Add a column containing the information content score  for each HPO ID.</p></li>
<li><p><code>add_mondo()</code>: add_
Add Mondo metadata</p>
<p>Add Mondo metadata (MONDO ID mappings, names, and definitions) for diseases
using files from their respective databases:
e.g. OMIM, DECIPHER, Orphanet.</p></li>
<li><p><code>add_ndisease()</code>: add_
Add N diseases</p>
<p>Annotate each HPO term with the total number of disease
they are associated with.</p></li>
<li><p><code>add_omop()</code>: add_
Add OMOP</p>
<p>Add metadata from <a href="https://mondo.monarchinitiative.org/" class="external-link">MONDO</a>,
including:</p><dl><dt>mondo_id</dt>
<dd><p>MONDO term ID.</p></dd>

<dt>mondo_name</dt>
<dd><p>MONDO term name.</p></dd>

<dt>mondo_def</dt>
<dd><p>MONDO term definition.</p></dd>


</dl></li>
<li><p><code>add_onset()</code>: add_
Add age of onset</p>
<p>Add age of onset for each HPO ID.
onset IDs and assigned "onset_score" values:</p><dl><dt>HP:0011461 </dt>
<dd><p>"Fetal onset" (onset_score=1)</p></dd>

<dt>HP:0030674 </dt>
<dd><p>"Antenatal onset" (onset_score=2)</p></dd>

<dt>HP:0003577 </dt>
<dd><p>"Congenital onset" (onset_score=3)</p></dd>

<dt>HP:0003623 </dt>
<dd><p>"Neonatal onset" (onset_score=4)</p></dd>

<dt>HP:0003593 </dt>
<dd><p>"Infantile onset" (onset_score=5)</p></dd>

<dt>HP:0011463 </dt>
<dd><p>"Childhood onset" (onset_score=6)</p></dd>

<dt>HP:0003621 </dt>
<dd><p>"Juvenile onset" (onset_score=7)</p></dd>

<dt>HP:0011462 </dt>
<dd><p>"Young adult onset" (onset_score=8)</p></dd>

<dt>HP:0003581 </dt>
<dd><p>"Adult onset" (onset_score=9)</p></dd>

<dt>HP:0003596 </dt>
<dd><p>"Middle age onset" (onset_score=10)</p></dd>

<dt>HP:0003584 </dt>
<dd><p>"Late onset" (onset_score=11)</p></dd>


</dl></li>
<li><p><code>add_ont_lvl()</code>: add_
Add ontology level</p>
<p>Add the relative ontology level for each HPO ID.</p></li>
<li><p><code>add_pheno_frequency()</code>: add_
Add phenotype frequency</p>
<p>Add phenotype-level frequency, i.e.
how often a phenotype occurs in a given disease.</p></li>
<li><p><code>add_prevalence()</code>: add_
Add prevalence</p>
<p>Add a column containing the prevalence score for each disease ("disease_id")
or phenotype ("hpo_id").</p></li>
<li><p><code>add_severity()</code>: add_
Add HPO modifiers</p>
<p>Annotate each HPO with modifier terms, including
(but not limited to) progression and severity ratings.
In order of increasing severity:</p><dl><dt>HP:0012825 </dt>
<dd><p>"Mild" (Severity_score=4)</p></dd>

<dt>HP:0012827 </dt>
<dd><p>"Borderline" (Severity_score=3)</p></dd>

<dt>HP:0012828 </dt>
<dd><p>"Severe" (Severity_score=2)</p></dd>

<dt>HP:0012829</dt>
<dd><p>"Profound" (Severity_score=1)</p></dd>


</dl></li>
<li><p><code>add_tier()</code>: add_
Add severity Tiers</p>
<p>Add severity Tier for each HPO ID, in accordance with the
rating system provided by
<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4262393/" class="external-link">
Lazarin et al (2014)</a>.
In order of increasing severity:</p><dl><dt>Tier 4 </dt>
<dd><p>Reduced fertility</p></dd>

<dt>Tier 3 </dt>
<dd><p>Sensory impairment: vision,
Immunodeficiency/cancer,
Sensory impairment: hearing,
Sensory impairment: touch, other (including pain),
Mental illness,
Dysmorphic features</p></dd>

<dt>Tier 2 </dt>
<dd><p>Shortened life span: premature adulthood,
Impaired mobility,
Internal physical malformation</p></dd>

<dt>Tier 1 </dt>
<dd><p>Shortened life span: infancy,
Shortened life span: childhood/adolescence,
Intellectual disability</p></dd>


</dl></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_ancestor</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span>, lvl<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding level-5 ancestor to each HPO ID.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding ancestor metadata.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ancestor metadata already present. Use force_new=TRUE to overwrite.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 10 associations remain after filtering.</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_death</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Annotating phenos with AgeOfDeath.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding genes and disease IDs.</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_phenotype_to_genes.html">load_phenotype_to_genes</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_severity</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_phenotype_to_genes.html">load_phenotype_to_genes</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_evidence</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Annotating gene-disease associations with Evidence Score</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Gathering data from GenCC.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Importing cached file.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Evidence scores for: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - 11050 diseases </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - 5533 genes</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: 2025-12-01</span>
<span class="r-in"><span><span class="va">phenotype_to_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_phenotype_to_genes.html">load_phenotype_to_genes</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_gene_frequency</span><span class="op">(</span>phenotype_to_genes <span class="op">=</span> <span class="va">phenotype_to_genes</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Annotating gene frequencies.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: genes_to_phenotype.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_genes</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding genes and disease IDs.</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_gpt_annotations</span><span class="op">(</span><span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: piggyback</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Translating ontology terms to ids.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 151 phenotypes do not have matching HPO IDs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading in GPT annotations for 16,982 phenotypes.</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_hpo_definition</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding term definitions.</span>
<span class="r-in"><span><span class="va">phenotype_to_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_phenotype_to_genes.html">load_phenotype_to_genes</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">phenotype_to_genes</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hpo_id"</span>,<span class="st">"hpo_name"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_hpo_id</span><span class="op">(</span>phenos<span class="op">=</span><span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_hpo_name</span><span class="op">(</span>phenos<span class="op">=</span><span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding HPO names.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Translating ontology terms to names.</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_info_content</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding information_content scores.</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_phenotype_to_genes.html">load_phenotype_to_genes</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype.hpoa</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_mondo</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: echogithub</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Mapping disease_id --&gt; mondo_id</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using cached ontology file (1/1):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  /github/home/.cache/R/KGExplorer/ontologies/github/mondo_v2025-11-04.rds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 / 52 (1.92%) mondo_id missing.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 / 52 (1.92%) mondo_name missing.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 16 / 52 (30.77%) mondo_def missing.</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_ndisease</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Annotating phenos with n_diseases</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: genes_to_phenotype.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype.hpoa</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_omop</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Annotating phenos with OMOP metadata.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0 / 10 (0%) OMOP_ID missing.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0 / 10 (0%) OMOP_NAME missing.</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_onset</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Annotating phenos with onset.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding genes and disease IDs.</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="make_.html">make_phenos_dataframe</a></span><span class="op">(</span>ancestor <span class="op">=</span> <span class="st">"Neurodevelopmental delay"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Extracting data for 24 descendents.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing gene counts.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding term definitions.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding level-2 ancestor to each HPO ID.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding ancestor metadata.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ancestor metadata already present. Use force_new=TRUE to overwrite.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 24 associations remain after filtering.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Getting absolute ontology level for 18,082 IDs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing ontology level / gene count ratio.</span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_ont_lvl</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_pheno_frequency</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Annotating phenotype frequencies.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding genes and disease IDs.</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_prevalence</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding genes and disease IDs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Mapping disease_id --&gt; mondo_id</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using cached ontology file (1/1):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  /github/home/.cache/R/KGExplorer/ontologies/github/mondo_v2025-11-04.rds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 13 / 7,426 (0.18%) mondo_id missing.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 13 / 7,426 (0.18%) mondo_name missing.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2,698 / 7,426 (36.33%) mondo_def missing.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Mapping disease_id --&gt; mondo_id</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using cached ontology file (1/1):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  /github/home/.cache/R/KGExplorer/ontologies/github/mondo_v2025-11-04.rds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 25 / 6,089 (0.41%) mondo_id missing.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 25 / 6,089 (0.41%) mondo_name missing.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1,066 / 6,089 (17.51%) mondo_def missing.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Prevalence added for 0 / 7,426 disease_id IDs (0%)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Prevalence added for 0 / 10 hpo_id IDs (0%)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Prevalence added for 0 / 6,885 mondo_id IDs (0%)</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_severity</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Annotating phenos with modifiers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading cached RDS file: phenotype_to_genes.txt</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> + Version: v2025-11-24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding genes and disease IDs.</span>
<span class="r-in"><span><span class="va">phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="main.html">example_phenos</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenos2</span> <span class="op">&lt;-</span> <span class="fu">add_tier</span><span class="op">(</span>phenos <span class="op">=</span> <span class="va">phenos</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Annotating phenos with Tiers.</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Brian Schilder, Robert Gordon-Smith, Nathan Skene.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

